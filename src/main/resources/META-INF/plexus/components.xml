<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright (C) 2016 Ronald Jack Jenkins Jr.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!-- Derived from components-fragment.xml in maven-release-manager and components.xml in maven-scm-client, see THIRDPARTY file for further legal information. -->
<component-set>
  <components>
    <!-- Smart Reactor. -->
    <component>
      <role>org.apache.maven.AbstractMavenLifecycleParticipant
      </role>
      <role-hint>rtr</role-hint>
      <implementation>info.ronjenkins.maven.rtr.RTR
      </implementation>
      <configuration>
        <startSteps>
          <startStep>validate-eligibility</startStep>
          <startStep>build-smart-reactor</startStep>
          <startStep>sanity-checks</startStep>
          <startStep>transform-poms</startStep>
          <startStep>rebuild-release-reactor</startStep>
          <startStep>rebuild-graph</startStep>
        </startSteps>
        <endSuccessSteps>
          <endSuccessStep>post-release-success</endSuccessStep>
        </endSuccessSteps>
        <endFailureSteps>
          <endFailureStep>post-release-failure</endFailureStep>
        </endFailureSteps>
      </configuration>
    </component>
    <!-- Smart Reactor release steps. -->
    <!-- validate-eligibility is declared via annotation -->
    <!-- build-smart-reactor is declared via annotation -->
    <!-- sanity-checks is declared via annotation -->
    <component>
      <role>info.ronjenkins.maven.rtr.steps.SmartReactorStep
      </role>
      <role-hint>transform-poms</role-hint>
      <implementation>info.ronjenkins.maven.rtr.steps.release.TransformProjectsIntoReleases
      </implementation>
      <configuration>
        <releasePhases>
          <releasePhase>check-poms</releasePhase>
          <releasePhase>conditional-check-dependency-snapshots
          </releasePhase><!-- custom -->
          <releasePhase>create-backup-poms</releasePhase>
          <releasePhase>indicate-presence-of-backup-poms</releasePhase><!-- custom -->
          <releasePhase>map-release-versions</releasePhase>
          <releasePhase>input-variables</releasePhase>
          <releasePhase>rewrite-poms-for-release</releasePhase>
          <releasePhase>end-release</releasePhase>
        </releasePhases>
        <rollbackPhases>
          <rollbackPhase>defensive-restore-backup-poms</rollbackPhase><!-- custom -->
          <rollbackPhase>remove-backup-poms</rollbackPhase><!-- custom -->
        </rollbackPhases>
      </configuration>
    </component>
    <!-- rebuild-release-reactor is declared via annotation -->
    <!-- rebuild-graph is declared via annotation -->
    <component>
      <role>info.ronjenkins.maven.rtr.steps.SmartReactorStep
      </role>
      <role-hint>post-release-success</role-hint>
      <implementation>info.ronjenkins.maven.rtr.steps.release.DoPostReleaseSuccess
      </implementation>
      <configuration>
        <releasePhases>
          <releasePhase>remove-backup-poms</releasePhase><!-- custom -->
        </releasePhases>
      </configuration>
    </component>
    <component>
      <role>info.ronjenkins.maven.rtr.steps.SmartReactorStep
      </role>
      <role-hint>post-release-failure</role-hint>
      <implementation>info.ronjenkins.maven.rtr.steps.release.DoPostReleaseFailure
      </implementation>
      <configuration>
        <releasePhases>
          <releasePhase>defensive-restore-backup-poms</releasePhase><!-- custom -->
          <releasePhase>remove-backup-poms</releasePhase><!-- custom -->
        </releasePhases>
      </configuration>
    </component>
    <!-- Phases used by the maven-release-manager. -->
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>check-poms</role-hint>
      <implementation>org.apache.maven.shared.release.phase.CheckPomPhase
      </implementation>
      <configuration>
        <scmRequired>true</scmRequired>
        <snapshotsRequired>true</snapshotsRequired>
      </configuration>
      <requirements>
        <requirement>
          <role>org.apache.maven.shared.release.scm.ScmRepositoryConfigurator
          </role>
          <role-hint>rtr-src</role-hint>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>conditional-check-dependency-snapshots</role-hint>
      <implementation>info.ronjenkins.maven.rtr.releasephases.ConditionalCheckDependencySnapshotsPhase
      </implementation>
      <requirements>
        <requirement>
          <role>org.apache.maven.artifact.factory.ArtifactFactory
          </role>
          <role-hint>rtr-af</role-hint>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>create-backup-poms</role-hint>
      <implementation>org.apache.maven.shared.release.phase.CreateBackupPomsPhase
      </implementation>
    </component>
    <!-- indicate-presence-of-backup-poms is declared via annotation -->
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>map-release-versions</role-hint>
      <implementation>org.apache.maven.shared.release.phase.MapVersionsPhase
      </implementation>
      <configuration>
        <convertToSnapshot>false</convertToSnapshot>
      </configuration>
      <requirements>
        <requirement>
          <role>org.codehaus.plexus.components.interactivity.Prompter
          </role>
          <role-hint>default</role-hint>
        </requirement>
        <requirement>
          <role>org.apache.maven.shared.release.policy.version.VersionPolicy
          </role>
          <field-name>versionPolicies</field-name>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>input-variables</role-hint>
      <implementation>org.apache.maven.shared.release.phase.InputVariablesPhase
      </implementation>
      <requirements>
        <requirement>
          <role>org.codehaus.plexus.components.interactivity.Prompter
          </role>
          <role-hint>default</role-hint>
        </requirement>
        <requirement>
          <role>org.apache.maven.shared.release.scm.ScmRepositoryConfigurator
          </role>
          <role-hint>rtr-src</role-hint>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>rewrite-poms-for-release</role-hint>
      <implementation>org.apache.maven.shared.release.phase.RewritePomsForReleasePhase
      </implementation>
      <configuration>
        <pomSuffix>tag</pomSuffix>
      </configuration>
      <requirements>
        <requirement>
          <role>org.apache.maven.shared.release.scm.ScmRepositoryConfigurator
          </role>
          <role-hint>rtr-src</role-hint>
        </requirement>
        <requirement>
          <role>org.apache.maven.shared.release.scm.ScmTranslator
          </role>
          <field-name>scmTranslators</field-name>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>end-release</role-hint>
      <implementation>org.apache.maven.shared.release.phase.EndReleasePhase
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.phase.ReleasePhase
      </role>
      <role-hint>defensive-restore-backup-poms</role-hint>
      <implementation>info.ronjenkins.maven.rtr.releasephases.DefensiveRestoreBackupPomsPhase
      </implementation>
      <requirements>
        <requirement>
          <role>org.apache.maven.shared.release.scm.ScmRepositoryConfigurator
          </role>
          <role-hint>rtr-src</role-hint>
        </requirement>
      </requirements>
    </component>
    <!-- remove-backup-poms is declared via annotation -->
    <!-- Transient dependencies required by the maven-release-manager classes. -->
    <component>
      <role>org.apache.maven.artifact.factory.ArtifactFactory
      </role>
      <role-hint>rtr-af</role-hint>
      <implementation>org.apache.maven.artifact.factory.DefaultArtifactFactory
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.artifact.handler.manager.ArtifactHandlerManager
      </role>
      <role-hint>rtr-ahm</role-hint>
      <implementation>org.apache.maven.artifact.handler.manager.DefaultArtifactHandlerManager
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.project.path.PathTranslator
      </role>
      <role-hint>rtr-pt</role-hint>
      <implementation>org.apache.maven.project.path.DefaultPathTranslator
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.config.ReleaseDescriptor
      </role>
      <role-hint>rtr-rd</role-hint>
      <implementation>org.apache.maven.shared.release.config.ReleaseDescriptor
      </implementation>
      <configuration>
        <interactive>${session.settings.interactive}</interactive>
        <workingDirectory>${session.request.baseDirectory}
        </workingDirectory>
      </configuration>
    </component>
    <component>
      <role>org.apache.maven.shared.release.env.ReleaseEnvironment
      </role>
      <role-hint>rtr-re</role-hint>
      <implementation>org.apache.maven.shared.release.env.DefaultReleaseEnvironment
      </implementation>
      <configuration>
        <!-- settings are injected from the session object at runtime -->
        <javaHome>${session.systemProperties.getProperty("user.home")}
        </javaHome>
        <mavenHome>${session.systemProperties.getProperty("maven.home")}
        </mavenHome>
        <localRepositoryDirectory>${session.request.localRepositoryPath}
        </localRepositoryDirectory>
      </configuration>
    </component>
    <component>
      <role>org.apache.maven.shared.release.scm.ScmRepositoryConfigurator
      </role>
      <role-hint>rtr-src</role-hint>
      <implementation>org.apache.maven.shared.release.scm.DefaultScmRepositoryConfigurator
      </implementation>
      <requirements>
        <requirement>
          <role>org.apache.maven.scm.manager.ScmManager</role>
          <role-hint>rtr-sm</role-hint>
        </requirement>
        <requirement>
          <role>org.sonatype.plexus.components.sec.dispatcher.SecDispatcher
          </role>
          <role-hint>mng-4384</role-hint>
          <field-name>secDispatcher</field-name>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.sonatype.plexus.components.sec.dispatcher.SecDispatcher
      </role>
      <role-hint>mng-4384</role-hint>
      <implementation>org.sonatype.plexus.components.sec.dispatcher.DefaultSecDispatcher
      </implementation>
      <requirements>
        <requirement>
          <role>org.sonatype.plexus.components.cipher.PlexusCipher
          </role>
          <role-hint>mng-4384</role-hint>
          <field-name>_cipher</field-name>
        </requirement>
      </requirements>
      <configuration>
        <_configuration-file>~/.m2/settings-security.xml
        </_configuration-file>
      </configuration>
    </component>
    <component>
      <role>org.sonatype.plexus.components.cipher.PlexusCipher</role>
      <role-hint>mng-4384</role-hint>
      <implementation>org.sonatype.plexus.components.cipher.DefaultPlexusCipher
      </implementation>
    </component>
    <component>
      <role>org.codehaus.plexus.components.interactivity.InputHandler
      </role>
      <role-hint>default</role-hint>
      <implementation>org.codehaus.plexus.components.interactivity.DefaultInputHandler
      </implementation>
      <instantiation-strategy>per-lookup</instantiation-strategy>
    </component>
    <component>
      <role>org.codehaus.plexus.components.interactivity.OutputHandler
      </role>
      <role-hint>default</role-hint>
      <implementation>org.codehaus.plexus.components.interactivity.DefaultOutputHandler
      </implementation>
      <instantiation-strategy>per-lookup</instantiation-strategy>
    </component>
    <component>
      <role>org.codehaus.plexus.components.interactivity.Prompter</role>
      <role-hint>default</role-hint>
      <implementation>org.codehaus.plexus.components.interactivity.DefaultPrompter
      </implementation>
      <instantiation-strategy>per-lookup</instantiation-strategy>
      <requirements>
        <requirement>
          <role>org.codehaus.plexus.components.interactivity.InputHandler
          </role>
          <role-hint>default</role-hint>
        </requirement>
        <requirement>
          <role>org.codehaus.plexus.components.interactivity.OutputHandler
          </role>
          <role-hint>default</role-hint>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.shared.release.policy.version.VersionPolicy
      </role>
      <role-hint>default</role-hint>
      <implementation>org.apache.maven.shared.release.policies.DefaultVersionPolicy
      </implementation>
    </component>
    <!-- SCM manager and providers. -->
    <component>
      <role>org.apache.maven.scm.manager.ScmManager
      </role>
      <role-hint>rtr-sm</role-hint>
      <implementation>org.apache.maven.scm.manager.plexus.DefaultScmManager
      </implementation>
      <requirements>
        <requirement>
          <role>org.apache.maven.scm.provider.ScmProvider</role>
          <field-name>scmProviders</field-name>
        </requirement>
      </requirements>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>accurev</role-hint>
      <implementation>org.apache.maven.scm.provider.accurev.AccuRevScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>bazaar</role-hint>
      <implementation>org.apache.maven.scm.provider.bazaar.BazaarScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>clearcase</role-hint>
      <implementation>org.apache.maven.scm.provider.clearcase.ClearCaseScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>hg</role-hint>
      <implementation>org.apache.maven.scm.provider.hg.HgScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>perforce</role-hint>
      <implementation>org.apache.maven.scm.provider.perforce.PerforceScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>cvs_native</role-hint>
      <implementation>org.apache.maven.scm.provider.cvslib.cvsexe.CvsExeScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>cvs</role-hint>
      <implementation>org.apache.maven.scm.provider.cvslib.cvsjava.CvsJavaScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>git</role-hint>
      <implementation>org.apache.maven.scm.provider.git.gitexe.GitExeScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>svn</role-hint>
      <implementation>org.apache.maven.scm.provider.svn.svnexe.SvnExeScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>starteam</role-hint>
      <implementation>org.apache.maven.scm.provider.starteam.StarteamScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>synergy</role-hint>
      <implementation>org.apache.maven.scm.provider.synergy.SynergyScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>vss</role-hint>
      <implementation>org.apache.maven.scm.provider.vss.VssScmProvider
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.scm.provider.ScmProvider</role>
      <role-hint>jazz</role-hint>
      <implementation>org.apache.maven.scm.provider.jazz.JazzScmProvider
      </implementation>
    </component>
    <!-- SCM translators. -->
    <component>
      <role>org.apache.maven.shared.release.scm.ScmTranslator</role>
      <role-hint>clearcase</role-hint>
      <implementation>org.apache.maven.shared.release.scm.ClearCaseScmTranslator
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.scm.ScmTranslator</role>
      <role-hint>cvs</role-hint>
      <implementation>org.apache.maven.shared.release.scm.CvsScmTranslator
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.scm.ScmTranslator</role>
      <role-hint>git</role-hint>
      <implementation>org.apache.maven.shared.release.scm.GitScmTranslator
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.scm.ScmTranslator</role>
      <role-hint>hg</role-hint>
      <implementation>org.apache.maven.shared.release.scm.HgScmTranslator
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.scm.ScmTranslator</role>
      <role-hint>jazz</role-hint>
      <implementation>org.apache.maven.shared.release.scm.JazzScmTranslator
      </implementation>
    </component>
    <component>
      <role>org.apache.maven.shared.release.scm.ScmTranslator</role>
      <role-hint>svn</role-hint>
      <implementation>org.apache.maven.shared.release.scm.SubversionScmTranslator
      </implementation>
    </component>
  </components>
</component-set>
